<!DOCTYPE html>
<html>
    <head>
        <title>My first three.js app</title>
        <style>
            body { margin: 0; }
        </style>
		<script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
    </head>
    <body>
        <script type="module">
            import * as THREE from 'https://unpkg.com/three/build/three.module.js';

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );

            const renderer = new THREE.WebGLRenderer();
            renderer.setSize( window.innerWidth, window.innerHeight );
            document.body.appendChild( renderer.domElement );

			// Control camera via clicking
			// const controls = new OrbitControls( camera, renderer.domElement );
			// controls.target.set( 0, 0.5, 0 );
			// controls.update();
			// controls.enablePan = false;
			// controls.enableDamping = true;

            // const geometry = new THREE.SphereGeometry( 1, 10, 10 );
			const geometry = new THREE.PlaneGeometry( 1, 1 , 100, 100);
            // const material = new THREE.MeshBasicMaterial( { color: 0x888888 } );
			const material = new THREE.MeshLambertMaterial( {
						color: 0xff00000,
						side: THREE.DoubleSide,
					} );

            const cube = new THREE.Mesh( geometry, material );

			const light = new THREE.HemisphereLight( 0xffffff, 0x080808, 1 );
			light.position.set( - 1.25, 1, 1.25 );
			scene.add( light );

			let position = geometry.getAttribute('position');

			geometry.verticesNeedUpdate = true
			position.needsUpdate = true;

            scene.add( cube );
			camera.position.z = 2;

			console.log(position)

			let raw_positions = position.clone()
			let t = 0

            const animate = function () {
                requestAnimationFrame( animate );

				const positions = position.array;

				// cube.rotation.x += 0.01;
                // cube.rotation.y += 0.01;
				t += 1/60

				for (let i=0; i < position.count; i ++) {
					let x = position.getX(i)
					let y = position.getY(i)
					let r = (x**2 + y **2) **.5
					let A = 0.3
					let s = 100  // spatial frequency
					let w = 2  // time frequency

					position.setZ(i, Math.exp(-0.1*r) * A * (Math.sin(s*r - w * t)))
				}

				position.needsUpdate = true;
				// controls.update();
                renderer.render( scene, camera );
            };

            animate();
        </script>
    </body>
</html>